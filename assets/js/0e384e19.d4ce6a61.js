"use strict";(self.webpackChunklogistics_real_time_flow=self.webpackChunklogistics_real_time_flow||[]).push([[671],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>g});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=r.createContext({}),p=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},c=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),d=p(n),m=o,g=d["".concat(s,".").concat(m)]||d[m]||u[m]||a;return n?r.createElement(g,l(l({ref:t},c),{},{components:n})):r.createElement(g,l({ref:t},c))}));function g(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,l=new Array(a);l[0]=m;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[d]="string"==typeof e?e:o,l[1]=i;for(var p=2;p<a;p++)l[p]=n[p];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},9881:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>d,frontMatter:()=>a,metadata:()=>i,toc:()=>p});var r=n(7462),o=(n(7294),n(3905));const a={sidebar_position:1},l="Installation Steps",i={unversionedId:"intro",id:"intro",title:"Installation Steps",description:"For Argolis Users",source:"@site/docs/intro.md",sourceDirName:".",slug:"/intro",permalink:"/logistics/docs/intro",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/intro.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",next:{title:"Features",permalink:"/logistics/docs/features"}},s={},p=[{value:"For Argolis Users",id:"for-argolis-users",level:2},{value:"Pre-requisites",id:"pre-requisites",level:3},{value:"Steps",id:"steps",level:3},{value:"Terraform Deployment Steps",id:"terraform-deployment-steps",level:3},{value:"Post Terraform Deployment",id:"post-terraform-deployment",level:3},{value:"Demo (Frontend Console &amp; Looker)",id:"demo-frontend-console--looker",level:3},{value:"Clean-up",id:"clean-up",level:3}],c={toc:p};function d(e){let{components:t,...a}=e;return(0,o.kt)("wrapper",(0,r.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"installation-steps"},"Installation Steps"),(0,o.kt)("h2",{id:"for-argolis-users"},"For Argolis Users"),(0,o.kt)("h3",{id:"pre-requisites"},"Pre-requisites"),(0,o.kt)("p",null,"Below applications need to be installed and available before the start of deployment."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"git"),(0,o.kt)("li",{parentName:"ol"},"terraform")),(0,o.kt)("h3",{id:"steps"},"Steps"),(0,o.kt)("p",null,"1) Log in via the admin user on GCP Argolis console. ",(0,o.kt)("strong",{parentName:"p"},"Its important to have the admin privileges because the automation will create a new project and associate the project with the billind id.")),(0,o.kt)("p",null,"2) Open the cloud shell via the GCP console."),(0,o.kt)("p",null,"3) Clone the repository by running the below command :"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"git clone https://github.com/jainsourabh2/logistics.git \n")),(0,o.kt)("p",null,"4) Navigate into logistics/terraform directory"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"cd logistics/terraform\n")),(0,o.kt)("p",null,"5) Open the terraform.tfvars file and change the values appropriately. Guidance to find organization and billing-account variables are given further in this step."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'project                 = "<unique_project_name>"\nregion                  = "<region-name>"\nzone                    = "<zone-name>"\nfolder                  = "logistics-demo"\norganization            = "<12 digit org id>"\nbilling-account         = "<XXXXXX-YYYYYY-ZZZZZZ>" \n')),(0,o.kt)("p",null,"Navigate to ",(0,o.kt)("strong",{parentName:"p"},"IAM & Admin")," -> ",(0,o.kt)("strong",{parentName:"p"},"Manage Resources")),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"GCP Org ID",src:n(5785).Z,width:"832",height:"282"})),(0,o.kt)("p",null,"Navigate to Billing Account details from GCP Console Hamburger menu as depicted below:"),(0,o.kt)("p",null,"Click on ",(0,o.kt)("strong",{parentName:"p"}," GO TO LINKED BILLING ACCOUNT")),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Navigate to Billing Option",src:n(7104).Z,width:"1354",height:"427"})),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"GCP Billing Account",src:n(1274).Z,width:"1352",height:"480"})),(0,o.kt)("h3",{id:"terraform-deployment-steps"},"Terraform Deployment Steps"),(0,o.kt)("p",null,"6) Run the below command to initialize terraform."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"terraform init\n")),(0,o.kt)("p",null,"7) Run the below command to validate the structure of terraform "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"terraform validate\n")),(0,o.kt)("p",null,"   You can optionally/additonally also run ",(0,o.kt)("strong",{parentName:"p"},"terraform plan")," to get a view of actions that will be performed."),(0,o.kt)("p",null,"8) Run the below command to apply changes in your project."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"terraform apply\n")),(0,o.kt)("p",null,'  Once you run the above command, you would be asked for confirmation. Please respond with a "yes" to proceed further.'),(0,o.kt)("p",null,"  ",(0,o.kt)("img",{alt:"Terraform Deployment",src:n(5003).Z,width:"536",height:"178"})),(0,o.kt)("p",null,"  Terraform Deployment completed message"),(0,o.kt)("p",null,"  ",(0,o.kt)("img",{alt:"Terraform Apply Complete",src:n(5935).Z,width:"679",height:"64"})),(0,o.kt)("h3",{id:"post-terraform-deployment"},"Post Terraform Deployment"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"NOTE : In Argolis, by default org policy blocks unauthenticated access and hence the policy (constraints/iam.allowedPolicyMemberDomains) needs to be allowed and then unauthenticated access needs to be enabled on the cloud run URLs")),(0,o.kt)("p",null,"Navigate to ",(0,o.kt)("strong",{parentName:"p"},"IAM & Admin")," -> ",(0,o.kt)("strong",{parentName:"p"},"Organization Policies")," "),(0,o.kt)("p",null,"Search for ",(0,o.kt)("strong",{parentName:"p"},"Domain Restricted Sharing")," policy and Edit is as shown in the screenshot (1,2,3,4,5 depict the sections on this form where values need to be edited)"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Navigate Domain Restricted Sharing",src:n(2777).Z,width:"1354",height:"345"})),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Modify Domain Restricted Sharing",src:n(6231).Z,width:"603",height:"758"})),(0,o.kt)("p",null,"Finally, click ",(0,o.kt)("strong",{parentName:"p"},"Save")," to persist the change to the policy."),(0,o.kt)("p",null,"9) Post the deployment , provide the permissions to allow unauthenticated access to the 3 Cloud Run API services. "),(0,o.kt)("p",null,"  ",(0,o.kt)("strong",{parentName:"p"},"From"),":"),(0,o.kt)("p",null,"  ",(0,o.kt)("img",{alt:"Cloud Run Requires Authentication",src:n(7392).Z,width:"1345",height:"403"})),(0,o.kt)("p",null,"  ",(0,o.kt)("strong",{parentName:"p"},"To"),":"),(0,o.kt)("p",null,"  ",(0,o.kt)("img",{alt:"Cloud Allow Un-Authentication",src:n(438).Z,width:"1294",height:"707"})),(0,o.kt)("p",null,"  The above screenshot covers only one (bigtable-apis) of the 3 Cloud Run services. However, the process needs to be repeated for remaining 2 services as well (ingest-pubsub, order-frontend)"),(0,o.kt)("p",null,"  ",(0,o.kt)("img",{alt:"Cloud Allow Un-Authentication1",src:n(9511).Z,width:"1354",height:"307"})),(0,o.kt)("p",null,"10) Generate Dummy Orders using the test harness"),(0,o.kt)("p",null,"Navigate to the logistics--\x3etest-harness folder in cloud shell. (Ensure the project of cloud shell is set to the Newly created project as part of this demo).\nRun the python script as depicted in the screenshot below. It will generate 50 orders by default."),(0,o.kt)("p",null,"  ",(0,o.kt)("img",{alt:"Generate Test Data",src:n(8757).Z,width:"1346",height:"740"})),(0,o.kt)("p",null,"NOTE: If you need to generate more orders, the same can be done by editing the generate_data.py script's line that otherwise looks like-"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"for x in range(50):")),(0,o.kt)("p",null,"Change the value of 50 to any other desired number, save the file and run the generate_data.py script"),(0,o.kt)("p",null,"11) View the data in BigQuery tables"),(0,o.kt)("p",null,"Navigate to the new project in GCP Console and open BigQuery\nDrill down to the ",(0,o.kt)("inlineCode",{parentName:"p"},"logistics")," dataset and ",(0,o.kt)("inlineCode",{parentName:"p"},"logistics")," table therein."),(0,o.kt)("p",null,"Query it from query tab as shown in the screenshot below.\nGrab one of the sample package_id column values of ",(0,o.kt)("inlineCode",{parentName:"p"},"logistics")," table; the same will be used to query from Customer Package tracking Console meant for end-user."),(0,o.kt)("p",null,"   ",(0,o.kt)("img",{alt:"Capture Package Id from BQ",src:n(4453).Z,width:"1353",height:"620"})),(0,o.kt)("h3",{id:"demo-frontend-console--looker"},"Demo (Frontend Console & Looker)"),(0,o.kt)("p",null,"12) Query from Front-end console"),(0,o.kt)("p",null,"This particular functionality for Real-time low latency tracking of package is facilitated by ",(0,o.kt)("strong",{parentName:"p"},"Bigtable")," as the backend datastore."),(0,o.kt)("p",null,"Navigate to Cloud Run and click on the ",(0,o.kt)("inlineCode",{parentName:"p"},"order-frontend")," Service and copy the URL as shown in the below screenshot."),(0,o.kt)("p",null,"   ",(0,o.kt)("img",{alt:"Front-end URL",src:n(5400).Z,width:"1350",height:"234"})),(0,o.kt)("p",null,"Use the same (or any other) package_id copied during Step 11 and key-in the same into the field ",(0,o.kt)("inlineCode",{parentName:"p"},"Customer Package Lookup")," ID and click on ",(0,o.kt)("strong",{parentName:"p"},"Latest Location")," button."),(0,o.kt)("p",null,"Package Lookup Result provides the status of the package with latest hop being at the top."),(0,o.kt)("p",null,"   ",(0,o.kt)("img",{alt:"Front-end URL",src:n(2942).Z,width:"1349",height:"428"})),(0,o.kt)("p",null,"13) Looker based Dashboard Visualization"),(0,o.kt)("p",null,"This is Work In Progress."),(0,o.kt)("h3",{id:"clean-up"},"Clean-up"),(0,o.kt)("p",null,"14) Purge the Demo Setup"),(0,o.kt)("p",null,"Use the below terraform command from cloud shell to purge all the artefacts created as part of this demo's deployment in GCP."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"cd logistics/terraform\n")),(0,o.kt)("p",null,"and"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"terraform destroy\n")),(0,o.kt)("p",null,"If you face any errors, please contact ",(0,o.kt)("a",{parentName:"p",href:"mailto:sourabhsjain@google.com"},"sourabhsjain@google.com")," or ",(0,o.kt)("a",{parentName:"p",href:"mailto:trushar@google.com"},"trushar@google.com")))}d.isMDXComponent=!0},4453:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/Capture_pkgid_from_BQ-4d23c4d9225a228e0f708c0c49bf3d7d.png"},438:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/CloudRun_Allow_Unauth-381264ad9cbd0745c76db9f5ef35b4ef.png"},9511:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/CloudRun_Allow_Unauth_Done-3e70de5503f4877c298e71d3f65b0407.png"},7392:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/CloudRun_Require_Auth-28e59ad7e9ef6c93ddde23ca8676c902.png"},5400:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/Frontend_URL-71973c1cc032df6df5500d6d99ddf714.png"},1274:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/GCP_Billing_Account-9f9d5e0d63df8d3880e773ea22bd8ec2.png"},5785:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/GCP_Org_ID-007d2d3b69537c7565c193201076a2a7.png"},8757:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/Generate_test_data-27c5b64aae6fe2770e655b79173a3336.png"},6231:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/Modify_domain_rest_sharing-3ae74bef16a8a014cc7e303ee3b3b50d.png"},7104:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/Navigate_Billing-67fe23cda274c9e4a689c38fee5bd006.png"},2777:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/Navigate_domain_rest_sharing-c9390408c2d9fb51145f67d32f549c5f.png"},2942:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/Package_tracker_query-ae3080c4e1e825c6e8148e79725a928f.png"},5935:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/Terraform_apply_complete-23ead633f89613d1c8ae24e60363250c.png"},5003:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/Terraform_deploy_yes-6b69b9e1b338a8e6b7f7599008a3e217.png"}}]);